import pandas as pd
import json
from datasets import load_dataset
import random
def generate_general_evaluation_set():
    dataset = load_dataset("embedding-data/simple-wiki")
    dataset = dataset["train"].select(range(1000))
    dataset = dataset.to_pandas()
    dataset['sentence1'] = dataset['set'].apply(lambda x: x[0])
    dataset['sentence2'] = dataset['set'].apply(lambda x: x[1])
    dataset['labels'] = 0


    {
        "sentence1": "Partner with 3P and teams across Whole Foods Market and Amazon to ensure alignment, collaboration, and widespread sharing of lessons learned. A day in the life The Growth & Innovation Project Manager BASIC QUALIFICATIONS 3+ years of program or project management experience 3+ years of defining and implementing process improvement initiatives using data and metrics experience Knowledge of Excel (Pivot Tables, VLookUps) at an advanced level and SQL Experience using data and metrics to determine and drive improvements Experience working cross functionally with tech and non-tech teams PREFERRED QUALIFICATIONS 3+ years of driving end to end delivery, and communicating results to senior leadership experience 3+ years of driving process improvements experience Experience in stakeholder management, dealing with multiple stakeholders at varied levels of the organization Experience building processes, project management, and schedules Amazon is an equal opportunity employer and does not discriminate on the basis of protected veteran status, disability, or other legally protected status. Build effective working relationships with partners across the organization. Key job responsibilities Provide end-to-end project management support for Whole Foods Market and Amazon Retail Development projects. Network with other business groups to identify gaps / synergies and suggest process and communication improvements. Reporting to the Executive Leader, the Project Manager will be responsible for supporting a small team that works cross-functionally with stakeholders throughout Whole Foods Market and Amazon to (1) define and manage the work plan, resource needs, timeline, and budget for projects; (2) organize and drive resources to achieve project objectives on time, within scope, and on budget; and (3) ensure project scope, planning, and implementation align with business expectations and needs. Track and manage progress of tasks, identifying and communicating issues / risks to leadership; ensure changes are implemented and documented as required. Engage with stakeholders to understand business requirements including documentation expectations, resource limitations, risks, and challenges. Build and maintain project roadmaps, including milestones, deliverables, and overall timelines and report on progress, issues, and status. Engage with Team Members and leadership to ensure a mutual and shared understanding of project expectations. The ideal candidate has proven project management experience and a track record of successfully managing complex initiatives.",
        "sentence2": "\u2022 Familiar with sensors (proximity, photoelectric, capacitive), actuators, and safety devices (light curtains, e-stops, safety relays). \u2022 Able to create part lists and evaluate component specifications. \u2022 Experienced in instrumentation setup, calibration, and repair. Use electrical schematics and wiring diagrams to perform diagnostics and corrective actions. Troubleshoot and repair electrical systems including sensors, actuators, relays, and motor controls. \u2022 Able to handle small parts, less than a 1\u20444\" in size. Interface with CMMS and Microsoft Office tools to document work, track performance, and initiate part orders. \u2022 Familiar with Pick and Place automation \u2022 Capable of regularly walking up to 300 yards without rest. \u2022 OSHA 10 or better is preferred. Maintain devices and data collection systems for PdM and OEE. Comfortable working cross-functionally with engineering, production, IT, and EHS teams to support business goals. \u2022 Minimum 5 years of experience in automation, controls, and industrial maintenance. Collaboration & Continuous Improvement PLC, HMI & Automation \u2022 Knowledge of SCADA platforms and PLC programing languages (Ignition preferred and Python). Follow proper PPE, LOTO, arc flash protocols. Specify, install, configure, and calibrate process control instruments and electrical components. Install and configure network-connected devices (e.g., Ethernet/IP, Modbus TCP, OPC UA.) \u2022 Familiarity with tools such as multimeters, oscilloscopes, thermal imagers, signal generators, and PLC simulators. Install, set up, and troubleshoot variable frequency drives (VFDs). \u2022 Proficient in PLC and HMI programming (Mitsubishi preferred). \u2022 Ability to interpret and troubleshoot machine wiring, control panels, and industrial networking (Ethernet/IP, Modbus, Profibus). Perform root cause analysis (RCA) and implement long-term fixes based on system data and feedback. Electrical, Controls & Instrumentation Troubleshoot PLC logic (Mitsubishi preferred). Professional Competencies \u2022 High attention to detail with strong critical thinking and problem-solving skills. \u2022 Able to read, interpret and create schematics, diagrams, and technical documentation. Perform Job Safety Assessments (JSA) and maintain 6S in all work areas. Apply OSHA, NEC, NFPA 70E, and other standards to all work. PHYSICAL DEMANDS: The physical demands described here are representative of those that must be met by an employee to successfully perform the essential functions of this job. Reasonable accommodations may be made to enable individuals with disabilities to perform the essential functions. \u2022 Proficient in Microsoft Office Suite, and technical software. Provide training and guidance to apprentices and junior team members. \u2022 Able to stand, sit, crawl, kneel, twist, bend, lie prone and climb, for an 8-hour shift. \u2022 Technical degree in Mechatronics, Electrical/Instrumentation, or Controls. Or equivalent working experience \u2022 Skilled at troubleshooting using CMMS, technical manuals, and vendor resources. \u2022 Demonstrates energy, ownership, and accountability in all tasks. The Senior Mechatronics Technician supports production and facilities by developing, deploying, and maintaining mechanical, electrical, and automated systems. This position specializes in troubleshooting SCADA-connected systems, PLCs, instrumentation, and predictive maintenance technology. The role collaborates across departments to ensure operational uptime, safety, and continuous improvement. \u2022 Self-starter who can work independently and mentor others. ESSENTIAL DUTIES AND RESPONSIBILITIES: Equipment Maintenance EDUCATION AND/OR EXPERIENCE: \u2022 Capable of writing and updating standard operating procedures (SOPs), preventive maintenance instructions, and safety documentation. Lead troubleshooting and repair efforts, including robotics (Fanuc), pneumatics, hydraulics, and controls. \u2022 Skilled in troubleshooting and optimizing electrical and control systems. Behavioral & Interpersonal Skills Mentor junior technicians in maintenance techniques and safe practices. \u2022 Ability to frequently lift or move 50 pounds and occasionally lift or move more with assistance. \u2022 Able to work at heights above 20 feet while using ladders, power lifts and forklift baskets. Perform preventive and corrective maintenance on production and facilities equipment. \u2022 Must have excellent hand-eye coordination and reach with arms to grasp with hands. Networking & Digital Systems Interpret and work from mechanical schematics, prints, and manuals. \u2022 Knowledge of predictive and condition-based maintenance. \u2022 Proficient in installation, maintenance, and troubleshooting of VFDs, servo motors, and motion control systems. LICENSES AND CERTIFICATIONS: Participate in cross-functional projects to improve equipment reliability and uptime. QUALIFICATIONS: Technical Expertise \u2022 Strong verbal and written communication. \u2022 Adequate close, peripheral, depth perception and color vision. \u2022 Experience working on conveyors, material handling systems, hydraulic equipment, and automated production machinery. Coordinate with IT, Manufacturing Engineering, and Machine Development teams on automation and equipment upgrades. \u2022 Hearing ability to diagnose and repair equipment.",
        "labels": 0.0,
        "anchor_job_role": "Innovation Manager",
        "negative_job_roles": "Mechatronics Technician"
    },

    eval_set = []
    for i in range(500):
        eval_set.append({
            "sentence1": dataset['sentence1'].iloc[i],
            "sentence2": dataset['sentence2'].iloc[i],
            "labels": 0.0,
        })

        eval_set.append({
            "sentence1": dataset['sentence1'].iloc[i],
            "sentence2": dataset['sentence1'][~(dataset['sentence1'] == dataset['sentence1'].iloc[i])].sample(1).values[0],
            "labels": 1.0,
        })

    random.shuffle(eval_set)

    with open("datasets/evaluation_set/500_general_eval_set.json", "w") as f:
        json.dump(eval_set, f, indent=4)

    # dataset = dataset.map(lambda x: {"text": x["text"]})
    # dataset.save_to_disk("general_eval_set.json")

if __name__ == "__main__":
    generate_general_evaluation_set()
